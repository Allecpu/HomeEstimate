<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Popup HomeEstimate</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #667eea;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      background: #f9f9f9;
      border-left: 4px solid #667eea;
    }
    .test-section h2 {
      margin-top: 0;
      font-size: 18px;
    }
    .status {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
    }
    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .status.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
    }
    button:hover {
      background: #5568d3;
    }
    pre {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>üß™ Test Estensione HomeEstimate</h1>

    <div class="test-section">
      <h2>1. Verifica File</h2>
      <div id="fileCheck"></div>
    </div>

    <div class="test-section">
      <h2>2. Istruzioni per Test</h2>
      <div class="status info">
        <strong>Come testare l'estensione:</strong>
        <ol>
          <li>Vai su <code>chrome://extensions/</code></li>
          <li>Attiva "Modalit√† sviluppatore"</li>
          <li>Clicca "Carica estensione non pacchettizzata"</li>
          <li>Seleziona la cartella: <code>browser-extension</code></li>
          <li>Vai su un annuncio di Idealista.it</li>
          <li>Clicca sull'icona dell'estensione</li>
          <li>Clicca "Estrai Dati da Questa Pagina"</li>
        </ol>
      </div>
    </div>

    <div class="test-section">
      <h2>3. URL di Test</h2>
      <p>Usa questi link per testare l'estensione:</p>
      <button onclick="window.open('https://www.idealista.it/', '_blank')">Apri Idealista.it</button>
      <button onclick="window.open('https://www.immobiliare.it/', '_blank')">Apri Immobiliare.it</button>
      <button onclick="window.open('https://www.casa.it/', '_blank')">Apri Casa.it</button>
    </div>

    <div class="test-section">
      <h2>4. Verifica Popup (Solo se apri questo file direttamente)</h2>
      <div class="status error">
        <strong>‚ö†Ô∏è Attenzione:</strong> Questo test mostra solo se il popup.html si carica correttamente.
        <br>Per testare completamente l'estensione, devi caricarla in Chrome come descritto sopra.
      </div>
      <button onclick="testPopupLoad()">Test Caricamento Popup</button>
      <div id="popupTest"></div>
    </div>

    <div class="test-section">
      <h2>5. Checklist Finale</h2>
      <div id="checklist">
        <label><input type="checkbox"> Estensione caricata in Chrome</label><br>
        <label><input type="checkbox"> Nessun errore su chrome://extensions/</label><br>
        <label><input type="checkbox"> Icona visibile nella toolbar</label><br>
        <label><input type="checkbox"> Popup si apre quando clicchi l'icona</label><br>
        <label><input type="checkbox"> Popup non √® vuoto (vedi pulsante viola)</label><br>
        <label><input type="checkbox"> Console mostra "HomeEstimate Popup: Script loaded"</label><br>
        <label><input type="checkbox"> Pulsante "Estrai Dati" √® cliccabile</label><br>
      </div>
    </div>
  </div>

  <script>
    // File check
    const files = [
      'manifest.json',
      'popup.html',
      'popup.js',
      'content.js',
      'injector.js',
      'icons/icon16.png',
      'icons/icon48.png',
      'icons/icon128.png'
    ];

    function checkFiles() {
      const fileCheckDiv = document.getElementById('fileCheck');
      fileCheckDiv.innerHTML = '<div class="status info">I file necessari sono:</div>';

      files.forEach(file => {
        fileCheckDiv.innerHTML += `<div>‚úì ${file}</div>`;
      });

      fileCheckDiv.innerHTML += '<div class="status success" style="margin-top: 10px;">Tutti i file dovrebbero essere presenti nella cartella browser-extension</div>';
    }

    function testPopupLoad() {
      const testDiv = document.getElementById('popupTest');
      testDiv.innerHTML = '<div class="status info">Caricamento popup.html in iframe...</div>';

      const iframe = document.createElement('iframe');
      iframe.src = 'popup.html';
      iframe.style.width = '400px';
      iframe.style.height = '500px';
      iframe.style.border = '2px solid #667eea';
      iframe.style.borderRadius = '8px';
      iframe.style.marginTop = '10px';

      iframe.onerror = () => {
        testDiv.innerHTML = '<div class="status error">‚ùå Errore nel caricamento di popup.html</div>';
      };

      iframe.onload = () => {
        testDiv.innerHTML = '<div class="status success">‚úì popup.html caricato (vedi sotto)</div>';
        testDiv.appendChild(iframe);
      };

      testDiv.appendChild(iframe);
    }

    // Run file check on load
    checkFiles();
  </script>
</body>
</html>
